---
id: other_commands
title: その他のコマンド
---

## GPUの使い方

個人ゲノム解析区画では、GPU計算ノードはノード単位で占有してジョブを割り当てる運用としています。ノード内のGPUを分割して利用する環境設定はしていません。このため、GPUを利用するジョブの投入時には、GPU利用をオプションで明示的に指定する必要はありません。


## ジョブの実行状態の確認(squeue)

### ジョブの投入状況の確認

squeueコマンドを利用してジョブの実行状態を確認することができます。オプションの詳細については[オンラインマニュアル](https://slurm.schedmd.com/squeue.html#SECTION_OPTIONS)を参照してください。

実行例

```
squeue
(実際の環境で更新予定)
```

squeueでデフォルトで表示される項目は以下のようになります


|項目名|説明|
|-------|----|
|JOBID|ジョブに割り当てられたジョブIDが表示されます。|
|PARTITION | ジョブが投入されたパーティション(キュー)名を表示します。|
|NAME|ジョブ名（未指定の場合はコマンド文字列）を表示します。|
|USER |ジョブを投入したユーザ名が表示されます。|
|ST|ジョブの状態を表示します。主なジョブの状態を以下の表に示します。|
|TIME|ジョブの実行時間（形式：days-hh:mm:ss）|
|NODES|ジョブ実行に使用されるノード数 |
|NODELIST(REASON)|ジョブが実行されるホスト名のリスト|


**ジョブの状態説明（STフィールド）**

|状態の文字|説明|
|---|---|
|CA　(CANCELLED) | ジョブが明示的にユーザまたはシステム管理者によってキャンセルされました。|
|CD　(COMPLETED) |ジョブは、すべてのノード上のすべてのプロセスを終了しました。|
|CF　(CONFIGURING) |ジョブは、資源が割り当てられた後、資源が使える状態になるのを待っている状態です。|
|CG　(COMPLETING)|ジョブは、終了手続きの過程にあります。|
|F　(FAILED)|ジョブは、ゼロ以外の終了コードまたはその他の障害状態で終了しました。|
|NF　(NODE_FAIL)|ジョブは、割り当てられたノードのいずれかの故障のために終了しました。|
|PD　(PENDING)|ジョブは、資源の割り当てを待っています。保留中です。|
|PR　(PREEMPTED)|ジョブが中断のために終了しました。|
|R　(RUNNING) |ジョブは、現在実行中です。|
|S　(SUSPENDED)|ジョブは、資源の割り当てを持っています（実行が中断されています）。|
|TO　(TIMEOUT) |ジョブは、その制限時間に達して終了しました。|

## ジョブの詳細情報確認(scontrol show job)

自分のジョブのより詳細な情報を確認したい場合は、squeueコマンドでジョブＩＤを確認した後に、scontrol show job により確認することができます。オプションの詳細については[オンラインマニュアル](https://slurm.schedmd.com/scontrol.html#SECTION_OPTIONS)を参照してください。

実行例

```
scontrol show job
（実際の環境で更新予定）
```

## クラスタ全体の混雑状況の確認方法(sinfo,squeue)

各キューのジョブの投入状況等を参照するには、sinfo,squeueコマンドを利用してください。

```
sinfo --lN

sinfo -s


（実際の環境で更新予定）
```


## ジョブの削除(scancel)

想定した以上に処理に時間がかかっている、ジョブの標準出力、標準エラー出力に出力されている途中結果からジョブが期待した動作をしていないと思われる場合は、scancelコマンドでジョブを削除します。

実行例

```
scancel ジョブID
（実際の環境で更新予定）

```

投入した複数のジョブを一括してキャンセルしたい場合は、以下の指定方法が利用可能です。


|scancelのオプション指定 |説明|
|---------------------|----|
| -u ユーザ名 |ユーザ名を指定してジョブを削除する|
|-p パーティション名|パーティション名を指定して、当該パーティションを対象にscancel実行ユーザのジョブを削除します。|
|-t ジョブの状態|ジョブの状態を指定してキャンセルします。PENDING、RUNNING、SUSPENDEDのいずれかを指定します。|


オプションの詳細については[オンラインマニュアル](https://slurm.schedmd.com/scancel.html#SECTION_OPTIONS)を参照してください。

## ジョブの実行結果の確認

ジョブの結果は、sbatchのコマンドラインオプションで特に何も指定しなければ、ファイル名がslurm-ジョブ名.outのファイルににジョブの標準出力が出力されています。

sacctコマンドでジョブの実行履歴を確認することが可能です。オプションの詳細については[オンラインマニュアル](https://slurm.schedmd.com/sacct.html#SECTION_OPTIONS)を参照してください。

```
sacct -j
（実際の環境で更新予定）
```

## Slurm実行に必要な環境変数などのセットアップ

Slurmのsbatchなどのコマンドを実行できるようになるためには、Slurmの各種コマンドがインストールされたディレクトリにパスを通す必要があります。個人ゲノム解析区画のslurm用ログインノードにログインすると自動的に設定されるので通常は自分で設定する必要はありません。

Singularity コンテナからsbatchする場合など特殊なケースでは明示的にパスを通す必要があります。

 